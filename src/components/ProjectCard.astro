---
import TechnologyCard from "./TechnologyCard.astro";

const { imgSrc, title, description, buttonLink, status } = Astro.props;

// Lista de tecnologías
const technologies = [
  { name: "Spring Boot", iconSrc: "/AlbertoAndrade10.github.io/images/springboot.jpg" },
  { name: "Angular", iconSrc: "/AlbertoAndrade10.github.io/images/angular.jpg" },
  { name: "Docker", iconSrc: "/AlbertoAndrade10.github.io/images/docker.jpg" },
  { name: "MySQL", iconSrc: "/AlbertoAndrade10.github.io/images/mysql.jpg" },
  { name: "MongoDB", iconSrc: "/AlbertoAndrade10.github.io/images/mongo-icon.png" },
];
---

<div
  class="bg-white p-6 rounded-2xl shadow-lg hover:shadow-xl transition-shadow transform text-left"
>
  <!-- Imagen y Badge de Estado -->
  <div class="relative mb-4">
    <img
      src={imgSrc}
      alt={title}
      class="w-full h-48 object-cover rounded-t-lg"
    />
    <span
      class={`absolute top-4 right-4 px-3 py-1 rounded-full text-sm font-semibold ${
        status === "finalizado"
          ? "bg-green-500 text-white"
          : "bg-yellow-500 text-black"
      }`}
    >
      {status === "finalizado" ? "Finalizado" : "En Desarrollo"}
    </span>
  </div>

  <!-- Contenido Principal -->
  <div class="p-4">
    <h3 class="text-xl font-bold text-gray-800 mb-2">{title}</h3>

    <!-- Descripción  -->
    <div id="description-container" class="text-gray-600 mb-4">
      <p id="short-description" class="truncate max-h-12 overflow-hidden">
        {description}
      </p>
      <p id="full-description" class="hidden">
        {description}
      </p>
      <button
        id="toggle-description"
        class="text-indigo-600 hover:text-indigo-700 font-semibold cursor-pointer mt-2"
      >
        Ver más...
      </button>
    </div>

    <!-- Botón -->
    <a
      href={buttonLink}
      target="_blank"
      rel="noopener noreferrer"
      class="inline-block px-6 py-2 bg-indigo-600 text-white rounded-xl shadow hover:bg-indigo-700 transition duration-300 mb-4"
    >
      Ver Proyecto
    </a>

    <!-- Tecnologías -->
    <div class="flex flex-wrap gap-4">
      {
        technologies.map((tech) => (
          <TechnologyCard name={tech.name} iconSrc={tech.iconSrc} />
        ))
      }
    </div>
  </div>
</div>

<!-- script del comportamiento " ver mas " -->
<script>
  // Obtener referencias a los elementos
  const shortDescription = document.getElementById("short-description");
  const fullDescription = document.getElementById("full-description");
  const toggleButton = document.getElementById("toggle-description");

  // Verificar que todos los elementos existen antes de continuar
  if (shortDescription && fullDescription && toggleButton) {
    toggleButton.addEventListener("click", () => {
      if (fullDescription.classList.contains("hidden")) {
        // Mostrar descripción completa
        shortDescription.classList.add("hidden");
        fullDescription.classList.remove("hidden");
        toggleButton.textContent = "Mostrar menos...";
      } else {
        // Mostrar descripción comprimida
        fullDescription.classList.add("hidden");
        shortDescription.classList.remove("hidden");
        toggleButton.textContent = "Mostrar más...";
      }
    });
  } else {
    console.error(
      "Uno o más elementos requeridos no se encontraron en el DOM: 'short-description', 'full-description', 'toggle-description'."
    );
  }
</script>
